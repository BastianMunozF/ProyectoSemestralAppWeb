"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7895],{7895:(T,j,s)=>{s.r(j),s.d(j,{ViajesiniciadosPageModule:()=>q});var _=s(6814),b=s(6223),n=s(9843),u=s(2058),f=s(7791),i=s(5879),h=s(4535),d=s(2296);function g(o,c){if(1&o&&(i.TgZ(0,"ion-item")(1,"ion-label")(2,"strong"),i._uU(3,"Pasajeros:"),i.qZA()(),i.TgZ(4,"ion-label"),i._uU(5),i.qZA()()),2&o){const a=c.$implicit;i.xp6(5),i.AsE("",a.nombre," ",a.apellido,"")}}function m(o,c){if(1&o){const a=i.EpF();i.TgZ(0,"ion-item-sliding")(1,"ion-card")(2,"ion-card-content"),i.YNc(3,g,6,2,"ion-item",5),i.TgZ(4,"ion-item")(5,"ion-label"),i._uU(6),i.qZA()(),i.TgZ(7,"ion-item")(8,"ion-label"),i._uU(9),i.qZA()(),i.TgZ(10,"ion-item")(11,"ion-label"),i._uU(12),i.qZA()(),i.TgZ(13,"ion-item")(14,"ion-label"),i._uU(15),i.qZA()(),i.TgZ(16,"ion-item")(17,"ion-label"),i._uU(18),i.qZA()(),i.TgZ(19,"ion-item")(20,"ion-label"),i._uU(21),i.qZA()(),i._UZ(22,"br"),i.TgZ(23,"ion-item")(24,"ion-label")(25,"strong"),i._uU(26,"Veh\xedculo"),i.qZA()()(),i.TgZ(27,"ion-item")(28,"ion-label"),i._uU(29),i.qZA()(),i.TgZ(30,"ion-item")(31,"ion-label"),i._uU(32),i.qZA()(),i.TgZ(33,"ion-button",21),i.NdJ("click",function(){i.CHM(a);const t=i.oxw().$implicit,r=i.oxw();return i.KtG(r.iniciarViaje(t))}),i._uU(34,"Iniciar Viaje"),i.qZA(),i.TgZ(35,"ion-button",21),i.NdJ("click",function(){i.CHM(a);const t=i.oxw().$implicit,r=i.oxw();return i.KtG(r.cancelarViaje(t))}),i._uU(36,"Cancelar Viaje"),i.qZA()()()()}if(2&o){const a=c.$implicit,e=i.oxw().$implicit,t=i.oxw();i.xp6(3),i.Q6J("ngForOf",t.arregloUsuario),i.xp6(3),i.hij("Fecha del Viaje: ",e.f_viaje,""),i.xp6(3),i.hij("Hora de Salida: ",e.hora_salida,""),i.xp6(3),i.hij("Salida: ",e.salida,""),i.xp6(3),i.hij("Destino: ",e.destino,""),i.xp6(3),i.hij("Asientos disponibles: ",e.cant_asientos,""),i.xp6(3),i.hij("Estado: ",e.estado,""),i.xp6(8),i.hij("Marca: ",a.marca,""),i.xp6(3),i.hij("Modelo: ",a.modelo,"")}}function l(o,c){if(1&o&&(i.TgZ(0,"ion-item-sliding"),i.YNc(1,m,37,9,"ion-item-sliding",5),i.qZA()),2&o){const a=i.oxw();i.xp6(1),i.Q6J("ngForOf",a.arregloVehiculo)}}const x=function(){return["/viajescurso"]},A=function(){return["/menuprincipalconductor"]},U=function(){return["/rutaconductor"]},P=function(){return["/perfilconductor"]},y=function(){return["/registrarvehiculo"]},M=function(){return["/paginalogin-usuario"]},w=[{path:"",component:(()=>{var o;class c{constructor(e,t){this.database=e,this.alertController=t,this.arregloDetalle=[{id_detalle:"",id_usuario:"",id_viaje:""}],this.arregloUsuario=[{id_usuario:"",nombre:"",apellido:"",correo:"",fechanacimiento:"",rut:"",celular:"",contrasena:"",fotoperfil:""}],this.arregloVehiculo=[{id_vehiculo:"",marca:"",modelo:"",anio:"",patente:"",asientos:"",id_usuario:"",id_tipo:""}],this.arregloViajes=[{id_viaje:"",f_viaje:"",hora_salida:"",salida:"",destino:"",cant_asientos:"",valor_asiento:"",estado:"",id_usuario:""}]}ngOnInit(){let e=localStorage.getItem("id");this.database.buscarViajeIniciado(e,"Disponible.").then(r=>{r.length>0?(console.log("Viajes del usuario: ",r),this.database.fetchViajeAceptado().subscribe(p=>{p.length>0&&(console.log("Viajes del usuario: ",p),this.arregloViajes=p,this.database.buscarDetalleViaje(this.arregloViajes.id_viaje).then(V=>{if(V.length>0){this.arregloDetalle=V;for(let Z=0;Z<this.arregloDetalle.length;Z++)this.database.buscarDatosUsuario(this.arregloDetalle[Z].id_usuario).then(v=>{v.length>0&&this.arregloUsuario.push(v)})}}))})):this.presentarAlerta("Error al cargar viajes","Usted a\xfan no tiene viajes iniciados.")}),this.database.buscarVehiculoUsuario(e),this.database.fetchVehiculoUser().subscribe(r=>{this.arregloVehiculo=r})}iniciarViaje(e){this.database.actualizarViaje("Iniciado.",e.id_viaje).then(r=>{if(r){this.presentarAlerta("Viaje Iniciado","Su viaje ha sido iniciado con \xe9xito.");const p=this.arregloViajes.indexOf(e);-1!==p&&this.arregloViajes.splice(p,1)}else this.presentarAlerta("Error al iniciar viaje","No se ha podido iniciar el viaje correctamente.")})}cancelarViaje(e){this.database.eliminarViajeUser(e.id_viaje).then(t=>{if(t){this.presentarAlerta("Viaje Cancelado","Su viaje ha sido cancelado con \xe9xito.");const r=this.arregloViajes.indexOf(e);-1!==r&&this.arregloViajes.splice(r,1)}else this.presentarAlerta("Error al cancelar viaje","No se ha podido cancelar el viaje correctamente.")})}presentarAlerta(e,t){var r=this;return(0,f.Z)(function*(){yield(yield r.alertController.create({header:e,message:t,buttons:["Aceptar"]})).present()})()}}return(o=c).\u0275fac=function(e){return new(e||o)(i.Y36(h.N),i.Y36(n.Br))},o.\u0275cmp=i.Xpm({type:o,selectors:[["app-viajesiniciados"]],decls:38,vars:14,consts:[[3,"translucent"],["color","primary",2,"text-align","center"],[2,"text-align","center"],["collapse","condense"],["color","primary",1,"ion-text-center"],[4,"ngFor","ngForOf"],[3,"routerLink"],[2,"display","flex","justify-content","center","align-items","center"],[1,"example-button-row"],[1,"example-flex-container"],["mat-icon-button","","aria-label","Example icon button with a vertical three-dot icon",2,"margin-right","20px",3,"routerLink"],["name","home","color","primary"],[1,"button-text"],["mat-icon-button","","color","primary","aria-label","Example icon button with a home icon",2,"margin-right","20px",3,"routerLink"],["name","location","color","primary"],["mat-icon-button","","color","accent","aria-label","Example icon button with a menu icon",2,"margin-right","20px",3,"routerLink"],["name","person","color","primary"],["mat-icon-button","","color","warn","aria-label","Example icon button with a heart icon",2,"margin-right","20px",3,"routerLink"],["name","car-sport","color","primary"],["mat-icon-button","","aria-label","Example icon button with an open in new tab icon",2,"margin-right","10px",3,"routerLink"],["name","exit","color","primary"],[3,"click"]],template:function(e,t){1&e&&(i.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title",2),i._uU(3,"ViaGo"),i.qZA()()(),i.TgZ(4,"ion-content")(5,"ion-header",3)(6,"ion-toolbar")(7,"ion-title"),i._uU(8,"Viajes Creados"),i.qZA()()(),i.TgZ(9,"h2",4),i._uU(10,"Sus viajes"),i.qZA(),i.TgZ(11,"ion-list"),i.YNc(12,l,2,1,"ion-item-sliding",5),i.qZA(),i.TgZ(13,"ion-button",6),i._uU(14,"Ver Viajes En Curso"),i.qZA()(),i.TgZ(15,"section",7)(16,"div",8)(17,"div",9)(18,"button",10),i._UZ(19,"ion-icon",11),i.TgZ(20,"span",12),i._uU(21,"Inicio"),i.qZA()(),i.TgZ(22,"button",13),i._UZ(23,"ion-icon",14),i.TgZ(24,"span",12),i._uU(25,"Viaje"),i.qZA()(),i.TgZ(26,"button",15),i._UZ(27,"ion-icon",16),i.TgZ(28,"span",12),i._uU(29,"Perfil"),i.qZA()(),i.TgZ(30,"button",17),i._UZ(31,"ion-icon",18),i.TgZ(32,"span",12),i._uU(33,"Auto"),i.qZA()(),i.TgZ(34,"button",19),i._UZ(35,"ion-icon",20),i.TgZ(36,"span",12),i._uU(37,"Cierre"),i.qZA()()()()()),2&e&&(i.Q6J("translucent",!0),i.xp6(12),i.Q6J("ngForOf",t.arregloViajes),i.xp6(1),i.Q6J("routerLink",i.DdM(8,x)),i.xp6(5),i.Q6J("routerLink",i.DdM(9,A)),i.xp6(4),i.Q6J("routerLink",i.DdM(10,U)),i.xp6(4),i.Q6J("routerLink",i.DdM(11,P)),i.xp6(4),i.Q6J("routerLink",i.DdM(12,y)),i.xp6(4),i.Q6J("routerLink",i.DdM(13,M)))},dependencies:[_.sg,n.YG,n.PM,n.FN,n.W2,n.Gu,n.gu,n.Ie,n.td,n.Q$,n.q_,n.wd,n.sr,n.YI,u.rH,d.RK],styles:['@charset "UTF-8";#container[_ngcontent-%COMP%]{color:#000;width:95%;border-bottom:5%;border:solid 1.5px #469597}#us[_ngcontent-%COMP%]{margin-left:3%;font-family:calibri;font-size:xx-large}#letra[_ngcontent-%COMP%]{font-family:arial;font-size:medium;font-weight:500}.color[_ngcontent-%COMP%]{color:var(--ion-color-new-shade)}ion-content[_ngcontent-%COMP%]{--ion-background-color:#f1f1ec;--ion-border-color:primary}.button-text[_ngcontent-%COMP%]{font-size:8px;margin-top:1px;display:block;text-align:center;color:#469597}']}),c})()}];let C=(()=>{var o;class c{}return(o=c).\u0275fac=function(e){return new(e||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({imports:[u.Bz.forChild(w),u.Bz]}),c})();var D=s(617),k=s(6385);let q=(()=>{var o;class c{}return(o=c).\u0275fac=function(e){return new(e||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({imports:[_.ez,b.u5,n.Pc,C,D.Ps,k.t,d.ot]}),c})()},7791:(T,j,s)=>{function _(n,u,f,i,h,d,g){try{var m=n[d](g),l=m.value}catch(x){return void f(x)}m.done?u(l):Promise.resolve(l).then(i,h)}function b(n){return function(){var u=this,f=arguments;return new Promise(function(i,h){var d=n.apply(u,f);function g(l){_(d,i,h,g,m,"next",l)}function m(l){_(d,i,h,g,m,"throw",l)}g(void 0)})}}s.d(j,{Z:()=>b})}}]);