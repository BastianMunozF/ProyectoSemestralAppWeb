"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[255],{255:(N,h,l)=>{l.r(h),l.d(h,{EditarperfilusuarioPageModule:()=>F});var d=l(6814),a=l(6223),x=l(617),y=l(6385),Z=l(2296),e=l(9843),p=l(2058),b=l(5861),g=l(8162),o=l(5879),U=l(4535);function P(i,c){if(1&i){const n=o.EpF();o.TgZ(0,"div",31),o.NdJ("click",function(){o.CHM(n);const r=o.oxw(2);return o.KtG(r.takePicture())}),o._UZ(1,"img",32),o.qZA()}if(2&i){const n=o.oxw().$implicit;o.xp6(1),o.Q6J("src",n.fotoperfil,o.LSH)}}const v=function(){return["/modificarcontrasena"]};function A(i,c){if(1&i){const n=o.EpF();o.TgZ(0,"ion-card")(1,"ion-card-title")(2,"ion-item",16)(3,"ion-label",17),o._uU(4,"Editar Perfil"),o.qZA()()(),o.TgZ(5,"ion-card-content")(6,"form",18),o.NdJ("ngSubmit",function(){o.CHM(n);const r=o.oxw();return o.KtG(r.actualizarUsuario())}),o.TgZ(7,"ion-label",19),o._uU(8,"Toca la foto para actualizar"),o.qZA(),o.YNc(9,P,2,1,"div",20),o.TgZ(10,"ion-item")(11,"ion-label",21),o._uU(12,"Nombre:"),o.qZA(),o._UZ(13,"ion-input",22),o.qZA(),o.TgZ(14,"ion-item")(15,"ion-label",21),o._uU(16,"Apellido:"),o.qZA(),o._UZ(17,"ion-input",23),o.qZA(),o.TgZ(18,"ion-item")(19,"ion-label",21),o._uU(20,"Correo:"),o.qZA(),o._UZ(21,"ion-input",24),o.qZA(),o.TgZ(22,"ion-item")(23,"ion-label",21),o._uU(24,"Fecha Nacimiento:"),o.qZA(),o._UZ(25,"ion-input",25),o.qZA(),o.TgZ(26,"ion-item")(27,"ion-label",21),o._uU(28,"Rut:"),o.qZA(),o._UZ(29,"ion-input",26),o.qZA(),o.TgZ(30,"ion-item")(31,"ion-label",21),o._uU(32,"Celular:"),o.qZA(),o._UZ(33,"ion-input",27),o.qZA(),o.TgZ(34,"div",28)(35,"ion-button",29),o._uU(36,"Modificar Contrase\xf1a"),o.qZA(),o.TgZ(37,"ion-button",30),o._uU(38,"Guardar"),o.qZA()()()()()}if(2&i){const n=c.$implicit,t=o.oxw();o.xp6(6),o.Q6J("formGroup",t.formularioActualizar),o.xp6(3),o.Q6J("ngIf",n.fotoperfil),o.xp6(20),o.Q6J("readonly",!0),o.xp6(6),o.Q6J("routerLink",o.DdM(4,v))}}const T=function(){return["/menuprincipal"]},E=function(){return["/tomarviaje"]},_=function(){return["/perfilusuario"]},C=function(){return["/comenzarviaje"]},z=function(){return["/paginalogin-usuario"]},M=[{path:"",component:(()=>{var i;class c{constructor(t,r,u,f){var s=this;this.router=t,this.database=r,this.fb=u,this.alertController=f,this.arregloUsuario=[{id_usuario:"",nombre:"",apellido:"",correo:"",fechanacimiento:"",rut:"",celular:"",contrasena:"",fotoperfil:""}],this.takePicture=(0,b.Z)(function*(){try{const m=yield g.V1.getPhoto({quality:90,allowEditing:!1,resultType:g.dk.DataUrl,source:g.oK.Prompt});m&&m.dataUrl?(s.image=m,s.fotoPerfil=m.dataUrl):(console.error("La imagen capturada es indefinida o no tiene dataUrl."),s.fotoPerfil="")}catch(m){console.error("Error al tomar la foto:",m),s.fotoPerfil=""}}),this.formularioActualizar=this.fb.group({nombre:new a.NI(""),apellido:new a.NI(""),correo:new a.NI(""),fechanacimiento:new a.NI(""),rut:new a.NI(""),celular:new a.NI("")})}ngOnInit(){let t=localStorage.getItem("id");this.database.buscarDatosUsuario(t).then(r=>{r&&(this.usuario=r[0],this.arregloUsuario=r,this.inicializarFormulario())})}ionViewWillEnter(){const t=localStorage.getItem("id");this.database.buscarDatosUsuario(t).then(r=>{r&&(this.usuario=r[0],this.inicializarFormulario())})}inicializarFormulario(){this.usuario&&this.formularioActualizar.patchValue({nombre:this.usuario.nombre||"",apellido:this.usuario.apellido||"",correo:this.usuario.correo||"",fechanacimiento:this.usuario.fechanacimiento||"",rut:this.usuario.rut||"",celular:this.usuario.celular||""})}onFileChange(t){const r=t.target.files[0];if(r){const u=new FileReader;u.onload=f=>{this.fotoPerfil=f.target.result},u.readAsDataURL(r)}else this.fotoPerfil=""}actualizarUsuario(){if(this.formularioActualizar.valid){var t;let r=this.formularioActualizar.value,u=localStorage.getItem("id"),f=this.fotoPerfil||(null===(t=this.usuario)||void 0===t?void 0:t.fotoperfil);this.database.actualizarPerfil(r.nombre,r.apellido,r.correo,r.fechanacimiento,r.rut,r.celular,f,u).then(s=>{null!==s?(console.log("Datos actualizados correctamente."),this.presentarAlerta("Datos actualizados","Sus datos han sido actualizados con \xe9xito."),this.router.navigate(["/perfilusuario"]),this.usuario=r,this.inicializarFormulario()):(console.log("Error al actualizar datos"),this.presentarAlerta("Error al actualizar datos","Rellene el formulario correctamente."))}).catch(s=>{console.error("Error en base de datos al actualizar datos: ",s)})}else this.presentarAlerta("Error en formulario","Rellene el formulario correctamente.")}presentarAlerta(t,r){var u=this;return(0,b.Z)(function*(){yield(yield u.alertController.create({header:t,message:r,buttons:["Aceptar"]})).present()})()}}return(i=c).\u0275fac=function(t){return new(t||i)(o.Y36(p.F0),o.Y36(U.N),o.Y36(a.qu),o.Y36(e.Br))},i.\u0275cmp=o.Xpm({type:i,selectors:[["app-editarperfilusuario"]],decls:29,vars:11,consts:[["color","primary",2,"text-align","center"],[4,"ngFor","ngForOf"],[2,"display","flex","justify-content","center","align-items","center"],[1,"example-button-row"],[1,"example-flex-container"],["mat-icon-button","","aria-label","Example icon button with a vertical three-dot icon",2,"margin-right","20px",3,"routerLink"],["name","home","color","primary"],[1,"button-text"],["mat-icon-button","","color","primary","aria-label","Example icon button with a home icon",2,"margin-right","20px",3,"routerLink"],["name","location","color","primary"],["mat-icon-button","","color","accent","aria-label","Example icon button with a menu icon",2,"margin-right","20px",3,"routerLink"],["name","person","color","primary"],["mat-icon-button","","color","warn","aria-label","Example icon button with a heart icon",2,"margin-right","20px",3,"routerLink"],["name","car-sport","color","primary"],["mat-icon-button","","aria-label","Example icon button with an open in new tab icon",2,"margin-right","10px",3,"routerLink"],["name","exit","color","primary"],["color","primary"],[2,"text-align","center","font-weight","800"],[3,"formGroup","ngSubmit"],["position","stacked"],["style","margin-left: 15px;","class","profile-picture",3,"click",4,"ngIf"],["position","floating"],["formControlName","nombre","type","text"],["formControlName","apellido","type","text"],["formControlName","correo","type","email"],["formControlName","fechanacimiento","type","date"],["formControlName","rut","type","text",3,"readonly"],["formControlName","celular","type","number"],[2,"display","flex","flex-direction","row","justify-content","space-between","align-items","center"],["color","primary",3,"routerLink"],["color","primary","type","submit"],[1,"profile-picture",2,"margin-left","15px",3,"click"],["alt","Foto de perfil",3,"src"]],template:function(t,r){1&t&&(o.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),o._uU(3,"ViaGo"),o.qZA()()(),o.TgZ(4,"ion-content"),o.YNc(5,A,39,5,"ion-card",1),o.qZA(),o.TgZ(6,"section",2)(7,"div",3)(8,"div",4)(9,"button",5),o._UZ(10,"ion-icon",6),o.TgZ(11,"span",7),o._uU(12,"Inicio"),o.qZA()(),o.TgZ(13,"button",8),o._UZ(14,"ion-icon",9),o.TgZ(15,"span",7),o._uU(16,"Viaje"),o.qZA()(),o.TgZ(17,"button",10),o._UZ(18,"ion-icon",11),o.TgZ(19,"span",7),o._uU(20,"Perfil"),o.qZA()(),o.TgZ(21,"button",12),o._UZ(22,"ion-icon",13),o.TgZ(23,"span",7),o._uU(24,"Auto"),o.qZA()(),o.TgZ(25,"button",14),o._UZ(26,"ion-icon",15),o.TgZ(27,"span",7),o._uU(28,"Cierre"),o.qZA()()()()()),2&t&&(o.xp6(5),o.Q6J("ngForOf",r.arregloUsuario),o.xp6(4),o.Q6J("routerLink",o.DdM(6,T)),o.xp6(4),o.Q6J("routerLink",o.DdM(7,E)),o.xp6(4),o.Q6J("routerLink",o.DdM(8,_)),o.xp6(4),o.Q6J("routerLink",o.DdM(9,C)),o.xp6(4),o.Q6J("routerLink",o.DdM(10,z)))},dependencies:[d.sg,d.O5,a._Y,a.JJ,a.JL,e.YG,e.PM,e.FN,e.Dq,e.W2,e.Gu,e.gu,e.pK,e.Ie,e.Q$,e.wd,e.sr,e.as,e.j9,e.YI,p.rH,a.sg,a.u,Z.RK],styles:['@charset "UTF-8";#container[_ngcontent-%COMP%]{color:#000;width:95%;border-bottom:5%;border:solid 1.5px #469597}#us[_ngcontent-%COMP%]{margin-left:3%;font-family:calibri;font-size:xx-large}#letra[_ngcontent-%COMP%]{font-family:arial;font-size:medium;font-weight:500}.color[_ngcontent-%COMP%]{color:var(--ion-color-new-shade)}ion-content[_ngcontent-%COMP%]{--ion-background-color:#f1f1ec;--ion-border-color:primary}.profile-picture[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:80px;height:80px;overflow:hidden;border-radius:50%;border:2px solid #fff}.profile-picture[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:50%}.button-text[_ngcontent-%COMP%]{font-size:8px;margin-top:1px;display:block;text-align:center;color:#469597}']}),c})()}];let w=(()=>{var i;class c{}return(i=c).\u0275fac=function(t){return new(t||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({imports:[p.Bz.forChild(M),p.Bz]}),c})(),F=(()=>{var i;class c{}return(i=c).\u0275fac=function(t){return new(t||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({imports:[d.ez,a.u5,e.Pc,w,a.UX,Z.ot,y.t,x.Ps]}),c})()}}]);